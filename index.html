<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#444">
    <meta name="msapplication-navbutton-color" content="#444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#444">
    <link ref="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
    <script src="utils.js"></script>
    <script src="fetch.js"></script>
    <script src="dom.js"></script>
    <script src="data.js"></script>
    <script>
      const linkIcon = url =>
        url.contains("mailto:") ? "far fa-envelope" :
        url.contains("github.com") ? "fab fa-github" :
        "fas fa-link";

      const link = (url, name) => [h.i({ class: linkIcon(url) }), h.a({ href: url }, name)];

      onload = () => {
        const downloadsTableTarget = document.getElementById("downloads-table");
        const communityTableTarget = document.getElementById("community-table");
        const put = (target, node) => target.parentNode.replaceChild(node, target);

        const [certifiedPorts, uncertifiedPorts] = ports
          .filter(p => !p.archival)
          .sortBy(p => p.platform)
          .partition(p => p.certified);

        put(downloadsTableTarget, setupDownloadsTable(certifiedPorts, uncertifiedPorts));

        getContributors(
          contributors => put(communityTableTarget, setupCommunityTable(contributors)),
          _ => put(communityTableTarget, errorCommunityTable()));
      };
    </script>
    <title>Shen Open Source Language</title>
  </head>
  <body>
    <main>
      <section>
        <img id="logo" src="https://cdn.rawgit.com/Shen-Language/shen-sources/master/assets/shen_noname.svg">
        <header id="logo-text">Shen</header>
      </section>
      <section>
        <header>About</header>
        <p>
          Shen is a portable functional programming language by <a href="http://www.marktarver.com/">Mark Tarver</a>. It is the successor to the award-winning Qi language, with the added goal of being highly portable across platforms.
        </p>
        <p>
          More information is available on the <a href="http://shenlanguage.org">official website</a> and in <a href="https://www.amazon.co.uk/Book-Shen-Third-Mark-Tarver/dp/1784562130/ref=sr_1_2?s=books&ie=UTF8&qid=1459204767&sr=1-2">The Book of Shen</a>.
        </p>
      </section>
      <section>
        <header>Features</header>
        <header class="small">Pattern Matching</header>
        <pre><code>(<span class="keyword">define</span> filter
  _ []       -> []
  <span class="variable">F</span> [<span class="variable">X</span> | <span class="variable">Xs</span>] -> [<span class="variable">X</span> | (filter <span class="variable">F</span> <span class="variable">Xs</span>)]<span class="large-spacer"> </span><span class="small-spacer">
                </span><span class="keyword">where</span> (<span class="variable">F</span> <span class="variable">X</span>)
  <span class="variable">F</span> [_ | <span class="variable">Xs</span>] -> (filter <span class="variable">F</span> <span class="variable">Xs</span>))

(<span class="keyword">define</span> element?
  _ []      -> false
  <span class="variable">X</span> [<span class="variable">X</span> | _] -> true
  <span class="variable">X</span> [_ | <span class="variable">Y</span>] -> (element? <span class="variable">X</span> <span class="variable">Y</span>))</code></pre>
        <header class="small">Backtracking</header>
        <pre><code>(<span class="keyword">define</span> walk
  _ []      <- (fail)
  <span class="variable">F</span> [<span class="variable">X</span> | _] -> <span class="variable">X</span> <span class="keyword">where</span> (<span class="variable">F</span> <span class="variable">X</span>)
  <span class="variable">F</span> [_ | <span class="variable">Y</span>] -> (walk <span class="variable">F</span> <span class="variable">Y</span>))</code></pre>
        <header class="small">Lambda Calculus Consistency</header>
        <pre><code>(<span class="keyword">define</span> y-combinator
  <span class="variable">F</span> -> ((/. <span class="variable">X</span> (<span class="variable">X</span> <span class="variable">X</span>))
        (/. <span class="variable">X</span> (<span class="variable">F</span> (/. <span class="variable">Y</span> ((<span class="variable">X</span> <span class="variable">X</span>) <span class="variable">Y</span>))))))</code></pre>
        <header class="small">Lazy Evalution</header>
        <pre><code>(<span class="keyword">let</span> <span class="variable">F</span> (freeze (output <span class="literal">"Hello!"</span>))
  (thaw <span class="variable">F</span>))

&gt; "Hello!"</code></pre>
        <header class="small">Optional Type Checking</header>
        <pre><code>(tc +)

(<span class="keyword">define</span> map
  {(<span class="variable">A</span> --> <span class="variable">B</span>) --> (list <span class="variable">A</span>) --> (list <span class="variable">B</span>)}
  _ []       -> []
  <span class="variable">F</span> [<span class="variable">X</span> | <span class="variable">Xs</span>] -> [(<span class="variable">F</span> <span class="variable">X</span>) | (map <span class="variable">F</span> <span class="variable">Xs</span>)])

(map (+ <span class="literal">1</span>) [<span class="literal">"a"</span> <span class="literal">"b"</span> <span class="literal">"c"</span>])

&gt; type error</code></pre>
        <header class="small">Configurable Type Rules</header>
        <pre><code>(<span class="keyword">datatype</span> maybe-type

  _____________________
    none : (maybe <span class="variable">A</span>);

         <span class="variable">X</span> : <span class="variable">A</span>;
  _____________________
  (some <span class="variable">X</span>) : (maybe <span class="variable">A</span>);

      <span class="variable">M</span> : (maybe <span class="variable">A</span>);
  _____________________
     (unwrap <span class="variable">M</span>) : <span class="variable">A</span>;)</code></pre>
        <header class="small">Integrated Logic Engine</header>
        <pre><code>(<span class="keyword">defprolog</span> member
  <span class="variable">X</span> [<span class="variable">X</span> | _] <-- ;
  <span class="variable">X</span> [_ | <span class="variable">Y</span>] <-- (member <span class="variable">X</span> <span class="variable">Y</span>);)

(prolog?
  (member <span class="variable">X</span> [<span class="literal">1</span> <span class="literal">2</span> <span class="literal">3</span>])
  (member <span class="variable">X</span> [<span class="literal">3</span> <span class="literal">4</span> <span class="literal">5</span>])
  (return <span class="variable">X</span>))

&gt; 3</code></pre>
        <header class="small">Built-in Compiler-Compiler</header>
        <pre><code>(<span class="keyword">define</span> bit?
  <span class="variable">B</span> -> (element? <span class="variable">B</span> [<span class="literal">0</span> <span class="literal">1</span>]))

(<span class="keyword">defcc</span> &lt;b&gt;
  <span class="variable">B</span> &lt;b&gt; := [<span class="variable">B</span> | &lt;b&gt;] <span class="keyword">where</span> (bit? <span class="variable">B</span>);
  <span class="variable">B</span>     := [<span class="variable">B</span>] <span class="keyword">where</span> (bit? <span class="variable">B</span>);)</code></pre>
        <header class="small">Unique Macros</header>
        <pre><code>(<span class="keyword">defmacro</span> infix-macro
  [<span class="variable">X</span> + <span class="variable">Y</span>] -> [+ <span class="variable">X</span> <span class="variable">Y</span>]
  [<span class="variable">X</span> * <span class="variable">Y</span>] -> [* <span class="variable">X</span> <span class="variable">Y</span>])</code></pre>
      </section>
      <section>
        <header>Demo</header>
        <p>
          An in-browser REPL is hosted <a href="http://gravicappa.github.io/shen-js/shen.html#/.doc/welcome.html">here</a> where you can try out Shen and take a brief tutorial.
        </p>
      </section>
      <section>
        <header>Downloads</header>
        <p>
          There are implementations of Shen for most platforms. Some have fallen out of date and could use support to reach Certified status and stay current.
        </p>
        <p>
          An implementation is considered Certified if it passes <a href="https://github.com/Shen-Language/shen-sources/tree/master/tests">the test suite</a> included with the <a href="https://github.com/Shen-Language/shen-sources/tree/master/sources">kernel sources</a>.
        </p>
        <p>
          To port Shen to a new platform, <a href="https://github.com/Shen-Language/shen-sources/blob/master/doc/porting.md">see the porting guide</a>. You can <a href="https://github.com/Shen-Language/shen-language.github.io/pull/new/master">submit a pull request</a> to get it added here.
        </p>
        <script id="downloads-table">
          const versionAttrs = kernel =>
            (parseFloat(kernel) >= latestKernelVersion) ? { class: "latest", title: "Up-to-date with the latest" } :
            (parseFloat(kernel) >= recentKernelVersion) ? { class: "recent", title: "Compatible with recent versions" } :
            { class: "outdated", title: "Several versions out-of-date" };

          const portRow = port =>
            h.tr(
              h.td(port.platform),
              h.td(link(
                port.url || "https://github.com/" + port.github,
                port.name || afterLastSlash(port.github || port.url))),
              h.td(versionAttrs(port.kernel), port.kernel));

          const setupDownloadsTable = (certifiedPorts, uncertifiedPorts) =>
            h.table(
              h.thead(h.tr(h.th("Platform"), h.th("Port"), h.th("Kernel"))),
              h.tbody(
                h.tr(h.th({ colspan: 3 }, "Certified")),
                certifiedPorts.map(portRow),
                h.tr(h.th({ colspan: 3 }, "Uncertified")),
                uncertifiedPorts.map(portRow)));
        </script>
      </section>
      <section>
        <header>Contributing</header>
        <p>
          The Shen Open Source Kernel is authored in Shen itself and hosted <a href="https://github.com/Shen-Language/shen-sources">on GitHub</a>. Bug reports and suggested enhancements are welcome!
        </p>
      </section>
      <section>
        <header>Community</header>
        <p>
          The following is a (non-exhaustive) list of developers who have contributed to the Shen Language Open Source Community. Thanks to everyone for contributing!
        </p>
        <script id="community-table">
          const setupCommunityTable = contributors =>
            h.table(
              h.thead(h.tr(h.th("Contributor"), h.th("Links"))),
              h.tbody(contributors
                .sortBy(c => (c.name || c.github || "").toLowerCase())
                .map(c =>
                  h.tr(
                    h.td(c.name || c.github),
                    h.td([
                      c.github && link("https://github.com/" + c.github, c.github),
                      c.blog && link(c.blog, "blog")
                    ])))));

          const errorCommunityTable = () =>
            h.div(
              h.p("Unable to load contributors"),
              h.p("GitHub rate limit may be expended, try again later"));
        </script>
      </section>
    </main>
  </body>
</html>
