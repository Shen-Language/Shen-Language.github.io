<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#444">
    <meta name="msapplication-navbutton-color" content="#444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#444">
    <link ref="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
    <script src="utils.js"></script>
    <script src="ast.js"></script>
    <script src="fetch.js"></script>
    <script src="dom.js"></script>
    <script src="data.js"></script>
    <script>
      const linkIcon = url =>
        url.contains("mailto:") ? "far fa-envelope" :
        url.contains("github.com") ? "fab fa-github" :
        "fas fa-link";

      const link = (url, name) => [h.i({ class: linkIcon(url) }), h.a({ href: url }, name)];

      onload = () => {
        const downloadsTableTarget = document.getElementById("downloads-table");
        const communityTableTarget = document.getElementById("community-table");
        const put = (target, node) => target.parentNode.replaceChild(node, target);

        const [certifiedPorts, uncertifiedPorts] = ports
          .filter(p => !p.archival)
          .sortBy(p => p.platform)
          .partition(p => p.certified);

        put(downloadsTableTarget, setupDownloadsTable(certifiedPorts, uncertifiedPorts));

        getContributors(
          contributors => put(communityTableTarget, setupCommunityTable(contributors)),
          _ => put(communityTableTarget, errorCommunityTable()));
      };
    </script>
    <title>Shen Open Source Language</title>
  </head>
  <body>
    <main>
      <section>
        <img id="logo" src="https://cdn.rawgit.com/Shen-Language/shen-sources/master/assets/shen.svg">
      </section>
      <section>
        <header>About</header>
        <p>
          Shen is a portable functional programming language by <a href="http://www.marktarver.com/">Mark Tarver</a>.
        </p>
        <p>
          More information is available on the <a href="http://shenlanguage.org">official website</a> and in <a href="https://www.amazon.co.uk/Book-Shen-Third-Mark-Tarver/dp/1784562130/ref=sr_1_2?s=books&ie=UTF8&qid=1459204767&sr=1-2">The Book of Shen</a>.
        </p>
      </section>
      <section>
        <header>Features</header>
        <header class="small">Pattern Matching</header>
        <pre><code>(<span class="keyword">define</span> filter
  <span class="pattern">_</span> <span class="pattern">[]</span>       <span>-></span> <span class="pattern">[]</span>
  <span class="variable">F</span> <span class="pattern">[<span class="variable">X</span> | <span class="variable">Xs</span>]</span> <span>-></span> [<span class="variable">X</span> | (filter <span class="variable">F</span> <span class="variable">Xs</span>)] <span class="keyword">where</span> (<span class="variable">F</span> <span class="variable">X</span>)
  <span class="variable">F</span> [<span class="pattern">_</span> | <span class="variable">Xs</span>] <span>-></span> (filter <span class="variable">F</span> <span class="variable">Xs</span>))</code></pre>
        <header class="small">Unique Macros</header>
        <pre><code>(<span class="keyword">defmacro</span> infix-macro
  [<span class="variable">X</span> <span>+</span> <span class="variable">Y</span>] <span>-></span> [<span>+</span> <span class="variable">X</span> <span class="variable">Y</span>]
  [<span class="variable">X</span> <span>*</span> <span class="variable">Y</span>] <span>-></span> [<span>*</span> <span class="variable">X</span> <span class="variable">Y</span>])</code></pre>
        <header class="small">Lambda Calculus Consistency</header>
        <pre><code>(<span class="keyword">define</span> y-combinator
  <span class="variable">F</span> <span>-></span> ((<span>/.</span> <span class="variable">X</span> (<span class="variable">X</span> <span class="variable">X</span>))
        (<span>/.</span> <span class="variable">X</span> (<span class="variable">F</span> (<span>/.</span> <span class="variable">Z</span> ((<span class="variable">X</span> <span class="variable">X</span>) <span class="variable">Z</span>))))))</code></pre>
        <header class="small">Optional Lazy Evalution</header>
        <header class="small">Configurable Static Type System</header>
        <header class="small">Integrated Logic Engine</header>
        <header class="small">Built-in Compiler-Compiler</header>
        <header class="small">Interactive Debugger</header>
      </section>
      <section>
        <header>Demo</header>
        <p>
          An in-browser REPL is hosted <a href="http://gravicappa.github.io/shen-js/shen.html#/.doc/welcome.html">here</a> where you can try out Shen and take a brief tutorial.
        </p>
      </section>
      <section>
        <header>Downloads</header>
        <p>
          There are implementations of Shen for most platforms. Some have fallen out of date and could use support to reach Certified status and stay current.
        </p>
        <p>
          An implementation is considered Certified if it passes <a href="https://github.com/Shen-Language/shen-sources/tree/master/tests">the test suite</a> included with the <a href="https://github.com/Shen-Language/shen-sources/tree/master/sources">kernel sources</a>.
        </p>
        <p>
          To port Shen to a new platform, <a href="https://github.com/Shen-Language/shen-sources/blob/master/doc/porting.md">see the porting guide</a>. You can <a href="https://github.com/Shen-Language/shen-language.github.io/pull/new/master">submit a pull request</a> to get it added here.
        </p>
        <script id="downloads-table">
          const versionAttrs = kernel =>
            (parseFloat(kernel) >= latestKernelVersion) ? { class: "latest", title: "Up-to-date with the latest" } :
            (parseFloat(kernel) >= recentKernelVersion) ? { class: "recent", title: "Compatible with recent versions" } :
            { class: "outdated", title: "Several versions out-of-date" };

          const portRow = port =>
            h.tr(
              h.td(port.platform),
              h.td(link(
                port.url || "https://github.com/" + port.github,
                port.name || afterLastSlash(port.github || port.url))),
              h.td(versionAttrs(port.kernel), port.kernel));

          const setupDownloadsTable = (certifiedPorts, uncertifiedPorts) =>
            h.table(
              h.thead(h.tr(h.th("Platform"), h.th("Port"), h.th("Kernel"))),
              h.tbody(
                h.tr(h.th({ colspan: 3 }, "Certified")),
                certifiedPorts.map(portRow),
                h.tr(h.th({ colspan: 3 }, "Uncertified")),
                uncertifiedPorts.map(portRow)));
        </script>
      </section>
      <section>
        <header>Contributing</header>
        <p>
          The Shen Open Source Kernel is authored in Shen itself and hosted <a href="https://github.com/Shen-Language/shen-sources">on GitHub</a>. Bug reports and suggested enhancements are welcome!
        </p>
      </section>
      <section>
        <header>Community</header>
        <p>
          The following is a (non-exhaustive) list of developers who have contributed to the Shen Language Open Source Community. Thanks to everyone for contributing!
        </p>
        <script id="community-table">
          const setupCommunityTable = contributors =>
            h.table(
              h.thead(h.tr(h.th("Contributor"), h.th("Links"))),
              h.tbody(contributors
                .sortBy(c => (c.name || c.github || "").toLowerCase())
                .map(c =>
                  h.tr(
                    h.td(c.name || c.github),
                    h.td([
                      c.github && link("https://github.com/" + c.github, c.github),
                      c.blog && link(c.blog, "blog")
                    ])))));

          const errorCommunityTable = () =>
            h.div(
              h.p("Unable to load contributors"),
              h.p("GitHub rate limit may be expended, try again later"));
        </script>
      </section>
    </main>
  </body>
</html>
